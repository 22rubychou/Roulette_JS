<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>隨機靸人</title>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      list-style-type: none;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100vw;
      height: 100vh;
      position: relative
    }

    .roll {
      width: 85vh;
      height: 85vh;
      border: 1px solid black;
      border-radius: 42.5vh;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      position: relative;


    }

    .roll::after {
      content: "";
      width: calc(70vh + 10px);
      height: calc(70vh + 10px);
      /* border: 1px solid #ce4e4e; */
      border-radius: 35vh;
      position: absolute;
      box-sizing: border-box;
      left: 60px;
      top: 60px;
      z-index:20;

    }
    .target{
      width: calc(20vh + 10px);
      height: calc(20vh + 10px);
      border: 10px solid #ce4e4e;
      border-radius: calc(10vh + 5px);
      position: absolute;
      box-sizing: border-box;
      left:calc( 50vw - 10vh - 5px);
      top:calc( 50vh - 10vh - 5px);
      z-index:90;
      background:white;
      box-shadow:0 0 5px #ccc;
      font-size:56px;
      text-shadow: 2px 2px 7px #999;
      display:flex;
      justify-content: center;
      align-items: center;
    }
    .cell {
      border-right: 42.5vh solid lightseagreen;
      border-top: calc(42.5vh * 3.14 / 22) solid transparent;
      border-bottom: calc(42.5vh * 3.14 / 22) solid transparent;
      position: absolute;
      transform-origin: 0 50%;
   
    }
    .out-circle{
      width: 85vh;
      height: 85vh;
      border-radius: 42.5vh;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      position: absolute;
      left:calc( 50vw - 42.5vh);
      top:calc( 50vh - 42.5vh);
      z-index:80;
    }
    .out-circle::after {
      content: "";
      width: calc(85vh + 10px);
      height: calc(85vh + 10px);
      border: 10px solid rgb(255, 255, 255);
      border-radius: 42.5vh;
      position: absolute;
      box-sizing: border-box;
      left: -5px;
      top: -5px;
      z-index:80;
      box-shadow:0 0 5px #555;
          }
    .out-circle::before {
      content: "";
      width: calc(70vh + 10px);
      height: calc(70vh + 10px);
      border: 10px solid rgba(255,255,255,0.7);
      border-radius: 35vh;
      position: absolute;
      box-sizing: border-box;
      left:calc(7.5vh - 10px);
      top:calc(7.5vh - 10px);
      z-index:80;
      background-color:rgba(255,255,255,0.3);
      box-shadow: 0 0 5px #555;
    }    
    hr{
      height: 1px;
      width: 42.5vh;
      background: #999;
      /* box-shadow: 1px 1px 3px #999; */
      border: 0;
      position: absolute;
      transform: rotate(8.18deg);
      transform-origin: 0 50%;
      z-index: 30;
      right: 0;
      
    }
    #mask{
      display:none;
      border-right-color:rgba(255, 255, 255, 0.7);
      z-index: 10;
    }
    .name-card{
      width:50px;
      height:100px;
      transform-origin:calc( (42.5vh - 55px) * -1);
      position: absolute;
      right:5px;
      display:flex;
      justify-content: center;
      align-items: center;
    }
    .name-card .name{
      transform:rotate(90deg);
      text-align: center;
      font-size:24px;
      text-shadow:0 0 5px 555;
      color:white;
    }
  </style>
</head>

<body>
<div class="target"></div>
  <div class="out-circle">

  </div>
  <div class="roll">
    <div class="cell" id="mask"></div>
  </div>


</body>

</html>
<script>
  let names = ["豪冠","威智","嘉泰","碧霞","宏禮",
               "怡菁","義學","湧銳","文軍","巧芸",
               "啟祥","志祥","君倪","浩農","菀云",
               "昱賢","怡婷","妘霓","柏森","依婷",
               "仕辰","勻皓"];
  let seats = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23];
  $(".out-circle").on("click", function () {
    let num = Math.floor(Math.random() * seats.length )
    running(num);
  })


  for (let i = 0; i < 22; i++) {
    if (i % 2 == 0) {
      $(".roll").append(`<div class="cell" style="transform:rotate(${i*16.36}deg)"></div>`)
    } else {
      $(".roll").append(`<div class="cell" style="transform:rotate(${i*16.36}deg);border-right-color:rgb(21, 94, 203)"></div>`)
    }
    $(".out-circle").append(`<div class="name-card" style="transform:rotate(${16.36*i}deg)"><div class="name">${names[i]}</div></div>`)
  }

  for (let i=0 ; i < seats.length; i++) {
    $(".out-circle").append(`<hr style="transform:rotate(${8.18+16.36*i}deg)">`)
    
  }
  function running(tar) {
    $("#mask").show();
    console.log(tar);
    let speed = 0;
    let power = 0;
    let lasttime=0;
    for (let j = 0; j < 4; j++) {
      if (j < 3) {
        for (let i = 0; i < seats.length; i++) {

          setTimeout(() => {
            $("#mask").css({
              "transform": `rotate(${i*16.36}deg)`
            })
          }, i * 25 * Math.pow(3, speed) + power);

        
        }
      } else {
        for (let i = 0; i < tar+1; i++) {

          setTimeout(() => {
            $("#mask").css({
              "transform": `rotate(${i*16.36}deg)`
            })
          }, i * 25 * Math.pow(2.5, speed) + power);
          lasttime=i * 25 * Math.pow(3, speed)  + power - (tar*270)

        }

      }
      power = power + seats.length * 25 * Math.pow(3, speed);
      speed++;
    }
    //console.log(lasttime)
    setTimeout(()=>{

      $(".target").html(names[tar])
    },lasttime);
  }
</script>